---
import { getGlobalStats } from '../../lib/data-service';
import { formatMoney, formatNumber } from '../../lib/format';

interface Props {
  year?: string;
  month?: number;
}

const { year = "2026", month = 1 } = Astro.props;
const { totalSpend, totalLeads, avgCPL } = await getGlobalStats({ year, month });
const roas = 3.4;
---

<div class="grid grid-cols-2 md:grid-cols-4 gap-3">

    <!-- Gasto Total -->
    <div class="bg-white p-4 rounded-xl border border-zinc-200 shadow-sm flex flex-col gap-1">
        <div class="flex items-center gap-2 mb-1">
            <div class="w-7 h-7 rounded-lg bg-blue-50 flex items-center justify-center">
                <i class="fa-solid fa-wallet text-blue-500 text-xs"></i>
            </div>
            <span class="text-[11px] font-semibold text-zinc-400 uppercase tracking-wider">Gasto Total</span>
        </div>
        <span class="text-2xl font-black text-zinc-900 tracking-tight">{formatMoney(totalSpend)}</span>
        <div class="text-[11px] font-medium text-emerald-600 flex items-center gap-1">
            <i class="fa-solid fa-arrow-up text-[9px]"></i> 12.3% vs mes ant.
        </div>
    </div>

    <!-- Leads Totales -->
    <div class="bg-white p-4 rounded-xl border border-zinc-200 shadow-sm flex flex-col gap-1">
        <div class="flex items-center gap-2 mb-1">
            <div class="w-7 h-7 rounded-lg bg-emerald-50 flex items-center justify-center">
                <i class="fa-solid fa-users text-emerald-500 text-xs"></i>
            </div>
            <span class="text-[11px] font-semibold text-zinc-400 uppercase tracking-wider">Leads Totales</span>
        </div>
        <span class="text-2xl font-black text-zinc-900 tracking-tight">{formatNumber(totalLeads)}</span>
        <div class="text-[11px] font-medium text-emerald-600 flex items-center gap-1">
            <i class="fa-solid fa-arrow-up text-[9px]"></i> 8.7% vs mes ant.
        </div>
    </div>

    <!-- CPL Promedio -->
    <div class="bg-white p-4 rounded-xl border border-zinc-200 shadow-sm flex flex-col gap-1">
        <div class="flex items-center gap-2 mb-1">
            <div class="w-7 h-7 rounded-lg bg-amber-50 flex items-center justify-center">
                <i class="fa-solid fa-chart-line text-amber-500 text-xs"></i>
            </div>
            <span class="text-[11px] font-semibold text-zinc-400 uppercase tracking-wider">CPL Promedio</span>
        </div>
        <span class="text-2xl font-black text-zinc-900 tracking-tight">{formatMoney(avgCPL)}</span>
        <div class="text-[11px] font-medium text-rose-500 flex items-center gap-1">
            <i class="fa-solid fa-arrow-up text-[9px]"></i> 3.1% vs mes ant.
        </div>
    </div>

    <!-- ROAS Promedio -->
    <div class="bg-white p-4 rounded-xl border border-zinc-200 shadow-sm flex flex-col gap-1">
        <div class="flex items-center gap-2 mb-1">
            <div class="w-7 h-7 rounded-lg bg-purple-50 flex items-center justify-center">
                <i class="fa-solid fa-chart-pie text-purple-500 text-xs"></i>
            </div>
            <span class="text-[11px] font-semibold text-zinc-400 uppercase tracking-wider">ROAS Promedio</span>
        </div>
        <span class="text-2xl font-black text-zinc-900 tracking-tight">{roas}x</span>
        <div class="w-full bg-zinc-100 h-1.5 rounded-full mt-1 overflow-hidden">
            <div class="bg-purple-500 h-full rounded-full" style="width: 85%"></div>
        </div>
    </div>

</div>
